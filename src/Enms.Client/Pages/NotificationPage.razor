@page "/notification/{id?}"

@namespace Enms.Client.Pages

@attribute [Authorize]
@using Enms.Business.Models.Base
@using Enms.Business.Models
@using Enms.Business.Models.Enums
@using Enms.Client.Shared.Models
@using Enms.Client.Shared.Streaming
@using Microsoft.AspNetCore.Authorization
@using Enms.Client.State
@inherits Enms.Client.Base.EnmsOwningComponentBase

@if (UserState.User.MaybeRepresentative is not
  { Role: RoleModel.OperatorRepresentative })
{
  <Loading T="NotificationModel" Id="@Id">
    <Found Context="model">
      <NotificationDetails Model="@model"/>
    </Found>
  </Loading>
  return;
}

<Mutating T="SystemNotificationModel" Id="@Id">
  <Edit Context="model">
    <NotificationEdit Model="@model"/>
  </Edit>
  <Details Context="model">
    <NotificationDetails Model="@model"/>
  </Details>
</Mutating>

@code {

  [Parameter]
  public string? Id { get; set; }

  [CascadingParameter]
  public UserState UserState { get; set; } = default!;
}
