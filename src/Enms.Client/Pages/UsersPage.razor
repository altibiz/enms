@page "/users"

@using Enms.Business.Models.Enums
@namespace Enms.Client.Pages

@attribute [Navigation(
  Title = "Users",
  Allows = [RoleModel.OperatorRepresentative],
  Order = -70,
  Icon = Icons.Material.Filled.SupervisedUserCircle
)]
@attribute [Authorize]
@using Enms.Business.Models.Composite
@using Enms.Business.Queries
@using Enms.Client.Shared.Models
@using Enms.Client.Shared.Streaming
@using Microsoft.AspNetCore.Authorization
@using Microsoft.Extensions.DependencyInjection
@using MudBlazor
@inherits Enms.Client.Base.EnmsOwningComponentBase

<Paging
  T="MaybeRepresentingUserModel"
  PageAsync="@(page => ScopedServices.GetRequiredService<RepresentativeQueries>().MaybeRepresentingUsers(pageNumber: page))">
  <Summary Context="maybeRepresentingUser">
    @{
      var href = $"user/{maybeRepresentingUser.User.Id}";

      <MudCard>
        <MudCardContent>
          <MaybeRepresentingUserSummary Model="@maybeRepresentingUser"/>
        </MudCardContent>
        <MudCardActions>
          <MudLink Href="@href">
            @Translate("Details")
          </MudLink>
        </MudCardActions>
      </MudCard>
    }
  </Summary>
</Paging>

<MudLink Href="user">
  @Translate("Create")
</MudLink>
