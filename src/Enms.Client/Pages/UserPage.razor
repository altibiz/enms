@page "/user/{id}"

@using Enms.Business.Models.Composite
@using Enms.Business.Queries
@using Enms.Client.Attributes
@using Enms.Client.Base
@using Enms.Client.Shared.Models
@using Enms.Client.Shared.Streaming
@using Microsoft.AspNetCore.Authorization
@using Microsoft.Extensions.DependencyInjection

@namespace Enms.Client.Pages

@attribute [Navigation(RouteValue = "id", Parents = new[] { typeof(UsersPage) })]
@attribute [Authorize]
@attribute [StreamRendering]

@inherits EnmsOwningComponentBase

<Loading
  T="MaybeRepresentingUserModel"
  LoadAsync="@(() => ScopedServices
    .GetRequiredService<RepresentativeQueries>()
    .MaybeRepresentingUserByUserId(Id))">
  <Found Context="model">
    <MaybeRepresentingUser Model="@model"/>
  </Found>
</Loading>

@code {
  [Parameter]
  public string Id { get; set; } = default!;
}
