@page "/"

@using MudBlazor
@namespace Enms.Client.Pages

@attribute [Navigation(
  Title = "Dashboard",
  RouteValue = "",
  Order = -100,
  Icon = Icons.Material.Filled.Dashboard
)]
@attribute [Authorize]
@using Enms.Client.State
@using Enms.Business.Models.Enums
@using Enms.Business.Queries.Agnostic
@using Microsoft.AspNetCore.Authorization
@using Microsoft.Extensions.DependencyInjection
@inherits Enms.Client.Base.EnmsOwningComponentBase

@if (user is null)
{
  NavigateToLogin();
  return;
}

@if (user.User.MaybeRepresentative is null)
{
  <MudText Typo="Typo.h3">
    @Translate("Welcome,") @(user.User.User.UserName).
  </MudText>
  <MudText Class="mt-4">
    @Translate("Please wait until your data arrives in our system.")
    @Translate("You will be notified when this happens via email.")
  </MudText>
  return;
}

@if (user.User.MaybeRepresentative is { } representative)
{
  @if (representative.Role == RoleModel.UserRepresentative)
  {
    return;
  }

  @if (representative.Role == RoleModel.OperatorRepresentative)
  {
    return;
  }
}

@code {

  [CascadingParameter]
  public UserState user { get; set; } = default!;
}
